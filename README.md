# excel_vba

# 엑셀을 통한 빅데이터 분석 기초

1) Data Handling Process
- 데이터 수집 -> 가공 -> 분석 -> 시각화 -> 자동화

- 가공과정에서 파워쿼리를 활용

2) 파워쿼리
- 표 개체 전환 프로세스 : 셀하나클릭 -> 리본메뉴(삽입) -> 표(Ctrl+T) -> 표스타일 지정 -> 표이름 바꾸기
- 파워쿼리 가공 표준 프로세스 : 셀하나클릭 -> 리본메뉴(데이터) -> 테이블 범위에서 -> 여러 수정시도 -> 워크시트
- 원본업뎃 > 쿼리내에서 새로고침 > 자동화 > 검증

3) 데이터를 의심하고 검증하라
- 정형/비정형데이터
- 데이터의 구조화 : 헤더는 셀병합없이 첫번째 행, 아래방향으로 데이터를 쌓아가기, 중복이 발생해도 비워두지 말고 입력
- 표개체 여부
- 필드별 데이터 타입 확인 : 숫자/문자/날짜/수식

4) 데이터 수집 
- <웹크롤링> 
- 특정사이트에서 url 복사
- 새통합문서 -> 리본메뉴(데이터) -> 기타원본에서 -> 웹 -> url 붙여넣기
- 원하는 항목선택 -> 데이터변환
- 첫행 머리글로 사용, 상위행제거, 데이터타입 변호나
- 자동업데이트 : 데이터 -> 속성 -> 네모작은상자 -> 특정시간 간격으로 자동 업데이트

- <특정폴더내, 엑셀파일 통합>
- 새 통합문서 > 리본 메뉴 > 데이터 > 데이터 가져오기 > 파일에서 > 폴더에서 > 파일 취합할 폴더 선택
- 우측 하단 > ‘결합’ 내림버튼 클릭 > ‘데이터 결합 및 변환‘ 클릭
- 첫번째파일(default 기준), test(sheet이름), sheet이름이 다르면 매개변수 클릭
- 파일위치가 변경될시, 홈 -> 데이터 원본설정 -> 원본변경 -> 열기 -> 미리보기새로고침 -> 모두 새로고침 -> 닫기 및 로드

- <시트통합>
- 데이터 -> 데이터가져오기 -> 파일 -> excel통합문서 -> 시트통합파일
- 가져오기 -> 여러항목선택 해제 -> 파일이름 -> 데이터변환 -> Data필드만 사용 -> 확장 -> 원래 열이름을 접두사로 사용 해제
- 첫행을 머리글로 이용, Filtering(Nan, Date)

5) 데이터 가공
- <크로스테이블 구조화>
- 표개체로 변경 -> 테이블 범위에서 -> 선택한 열만 pivot해제
- 열추가 -> 사용자지정열 -> text

- <추가 Union>
- 표개체로변경 -> 표이름변경 -> 테이블범위에서 -> Date Type으로 변경 -> 연결만 만들기(6개 다하고) -> 추가(union), cf) 병합(join)
- 3개이상의 table -> 추가 -> 확인







